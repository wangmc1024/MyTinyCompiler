<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>抽象语法树可视化</title>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js"></script>
    <script>
        let currentScale = 1.0;
        const minScale = 0.3;
        const maxScale = 3.0;
        const scaleStep = 0.1;
        
        function zoomIn() {
            if (currentScale < maxScale) {
                currentScale += scaleStep;
                updateZoom();
            }
        }
        
        function zoomOut() {
            if (currentScale > minScale) {
                currentScale -= scaleStep;
                updateZoom();
            }
        }
        
        function resetZoom() {
            currentScale = 1.0;
            updateZoom();
        }
        
        function updateZoom() {
            const mermaidContainer = document.getElementById('mermaid-container');
            if (mermaidContainer) {
                mermaidContainer.style.transform = `scale(${currentScale})`;
                mermaidContainer.style.transformOrigin = 'top left';
                
                // 更新缩放显示
                const zoomDisplay = document.getElementById('zoom-display');
                if (zoomDisplay) {
                    zoomDisplay.textContent = `${Math.round(currentScale * 100)}%`;
                }
            }
        }
        
        // 添加键盘快捷键支持
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey) {
                switch(event.key) {
                    case '=':
                    case '+':
                        event.preventDefault();
                        zoomIn();
                        break;
                    case '-':
                        event.preventDefault();
                        zoomOut();
                        break;
                    case '0':
                        event.preventDefault();
                        resetZoom();
                        break;
                }
            }
        });
        
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'default',
            flowchart: { 
                rankDir: 'TB',
                nodeSpacing: 10,
                rankSpacing: 30
            }
        });
    </script>
    <style>
        body { 
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .zoom-controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .zoom-btn {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.2s;
        }
        .zoom-btn:hover {
            background: #f0f0f0;
            border-color: #999;
        }
        .zoom-display {
            font-weight: bold;
            min-width: 50px;
            text-align: center;
        }
        .mermaid-container {
            width: 100%;
            overflow: auto;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            padding: 20px;
            transition: transform 0.2s ease;
        }
        .mermaid {
            min-width: fit-content;
            min-height: fit-content;
        }
        .shortcut-hint {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>AST Tree Visualization</h1>
        <div class="zoom-controls">
            <button class="zoom-btn" onclick="zoomOut()" title="缩小 (Ctrl+-)">-</button>
            <span class="zoom-display" id="zoom-display">100%</span>
            <button class="zoom-btn" onclick="zoomIn()" title="放大 (Ctrl++)">+</button>
            <button class="zoom-btn" onclick="resetZoom()" title="重置缩放 (Ctrl+0)">重置</button>
        </div>
    </div>
    <div class="shortcut-hint">提示: 使用 Ctrl++ 放大, Ctrl+- 缩小, Ctrl+0 重置</div>
    <div id="mermaid-container" class="mermaid-container">
        <div class="mermaid">
            graph TD
    1["topLevel"]
    1 --> 2
    2["declareList"]
    2 --> 3
    3["declare"]
    3 --> 4
    4["varList"]
    4 --> 5
    5["linkVarList"]
    2 --> 6
    6["linkDeclareList"]
    6 --> 7
    7["declare"]
    7 --> 8
    8["varList"]
    8 --> 9
    9["linkVarList"]
    6 --> 10
    10["linkDeclareList"]
    10 --> 11
    11["declare"]
    11 --> 12
    12["varList"]
    12 --> 13
    13["linkVarList"]
        </div>
    </div>
</body>
</html>